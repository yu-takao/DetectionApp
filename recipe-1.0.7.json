{
  "RecipeFormatVersion": "2020-01-25",
  "ComponentName": "com.trust.heartbeat",
  "ComponentVersion": "1.0.7",
  "ComponentType": "aws.greengrass.generic",
  "ComponentDescription": "Publish heartbeat to IoT Core periodically (venv, awsiotsdk).",
  "Manifests": [
    {
      "Artifacts": [
        { "URI": "s3://gg-artifacts-405351594292-ap-northeast-1/com.trust.heartbeat/1.0.7/heartbeat.py" }
      ],
      "Lifecycle": {
        "Install": {
          "Script": "set -e\npython3 -m venv '{work:path}/venv' || true\nPY='{work:path}/venv/bin/python'; PIP='{work:path}/venv/bin/pip'; if [ ! -x \"$PY\" ]; then PY=python3; PIP=pip; fi\n$PY -m pip install --upgrade pip\n$PIP install --upgrade awsiotsdk awscrt"
        },
        "Run": {
          "Script": "PY='{work:path}/venv/bin/python'; if [ ! -x \"$PY\" ]; then PY=python3; fi; GG_THING_NAME=\"{iot:thingName}\" HEARTBEAT_INTERVAL_SEC=\"30\" \"$PY\" {artifacts:path}/heartbeat.py",
          "RequiresPrivilege": true
        }
      }
    }
  ]
}
